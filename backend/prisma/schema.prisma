// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id            Int       @id @default(autoincrement())
  correo        String    @unique
  nombre        String
  apellidos     String
  clave_cifrada String
  equipos       Equipo[]
  tableros      Tablero[]
  permisos      Permiso[]
}

model Equipo {
  id          Int       @id @default(autoincrement())
  nombre      String
  creado      DateTime? @default(now())
  integrantes Usuario[]
  tableros    Tablero[]
}

model Tablero {
  id         Int       @id @default(autoincrement())
  nombre     String
  creado     DateTime? @default(now())
  modificado DateTime? @default(now()) @updatedAt
  publico    Boolean?  @default(false)
  acceso     ACCESO?   @default(LECTURA)
  Usuario    Usuario?  @relation(fields: [usuarioId], references: [id])
  usuarioId  Int?
  Equipo     Equipo?   @relation(fields: [equipoId], references: [id])
  equipoId   Int?
  Permiso    Permiso[]
}

model Permiso {
  id        Int     @id @default(autoincrement())
  usuario   Usuario @relation(fields: [usuarioId], references: [id])
  tablero   Tablero @relation(fields: [tableroId], references: [id])
  acceso    ACCESO  @default(LECTURA)
  usuarioId Int
  tableroId Int
}

enum ACCESO {
  LECTURA
  ESCRITURA
}
